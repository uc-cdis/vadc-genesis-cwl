apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: gwas-integration-test-wrapper-
  namespace: argo
  annotations:
    workflows.argoproj.io/version: ">= 3.1.0"
    workflow_name: "test-pheweb-download"
  labels:
    workflows.argoproj.io/archive-strategy: "true"
    gen3username: "user-vzpgb-40uchicago-2eedu"
    gen3teamproject: "2f677761735f70726f6a656374732f70726f6a65637431"
spec:
  entrypoint: gwas-workflow
  podGC:
    strategy: OnPodSuccess
  podMetadata:
    labels:
      gen3username: "user-vzpgb-40uchicago-2eedu"
    annotations:
      gen3username: "vzpgb@uchicago.edu"
  arguments:
    parameters:
      - name: template_version
        value: gwas-template-pheweb-download
      - name: workflow_name
        value: "test-pheweb-download"
      - name: team_project
        value: /gwas_projects/uchicago1
      - name: internal_api_env
        value: qa-mickey
      - name: source_id
        value: 2
      - name: source_population_cohort
        value: 404
      - name: hare_population
        value: "non-hispanic Asian"
      - name: hare_concept_id
        default: 2000007027
        value: 2000007027
      - name: n_pcs
        default: 0
        value: 3
      - name: variables
        value: |
          [
            {"variable_type": "custom_dichotomous", "cohort_ids": [300, 301], "provided_name": "test123"},
            {"variable_type": "concept", "concept_id": 2000000708, "prefixed_concept_id": null},
            {"variable_type": "concept", "concept_id": 2000000280, "prefixed_concept_id": null}
          ]
      - name: out_prefix
        value: vadc_genesis
      - name: outcome
        value: |-
          {"variable_type": "custom_dichotomous", "provided_name": "test123", "cohort_ids": [300, 301]}
      - name: pca_file
        value: /commons-data/pcs.RData
      - name: relatedness_matrix_file
        value: /commons-data/KINGmatDeg3.RData
      - name: genome_build
        enum:
          - "hg38"
          - "hg19"
        default: "hg19"
        value: "hg19"
      - name: n_segments
        value: 0
      - name: segment_length
        default: 10000
        value: 2000
      - name: variant_block_size
        default: 1024
        value: 100
      - name: mac_threshold
        value: 0
      - name: maf_threshold
        value: 0.01
      - name: imputation_score_cutoff
        value: 0.03
      - name: pvalue_cutoff
        default: 5e-8
        value: 5e-8
      - name: top_n_hits
        default: 100
        value: 100
      - name: gds_files
        value: |-
          [
            "/commons-data/gds/chr1.merged.vcf.gz.gds",
            "/commons-data/gds/chr2.merged.vcf.gz.gds",
            "/commons-data/gds/chr3.merged.vcf.gz.gds",
            "/commons-data/gds/chr4.merged.vcf.gz.gds",
            "/commons-data/gds/chr5.merged.vcf.gz.gds",
            "/commons-data/gds/chr6.merged.vcf.gz.gds",
            "/commons-data/gds/chr7.merged.vcf.gz.gds",
            "/commons-data/gds/chr8.merged.vcf.gz.gds",
            "/commons-data/gds/chr9.merged.vcf.gz.gds",
            "/commons-data/gds/chr10.merged.vcf.gz.gds",
            "/commons-data/gds/chr11.merged.vcf.gz.gds",
            "/commons-data/gds/chr12.merged.vcf.gz.gds",
            "/commons-data/gds/chr13.merged.vcf.gz.gds",
            "/commons-data/gds/chr14.merged.vcf.gz.gds",
            "/commons-data/gds/chr15.merged.vcf.gz.gds",
            "/commons-data/gds/chr16.merged.vcf.gz.gds",
            "/commons-data/gds/chr17.merged.vcf.gz.gds",
            "/commons-data/gds/chr18.merged.vcf.gz.gds",
            "/commons-data/gds/chr19.merged.vcf.gz.gds",
            "/commons-data/gds/chr20.merged.vcf.gz.gds",
            "/commons-data/gds/chr21.merged.vcf.gz.gds",
            "/commons-data/gds/chr22.merged.vcf.gz.gds",
            "/commons-data/gds/chrX.merged.vcf.gz.gds"
          ]
  volumes:
    - name: workdir
      emptyDir:
        sizeLimit: "3Gi"
  workflowTemplateRef:
    name: gwas-template-integration-pheweb-download
